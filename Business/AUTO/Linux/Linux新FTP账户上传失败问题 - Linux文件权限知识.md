### Linux新FTP账户上传失败问题 - Linux文件权限知识

------

##### 1.问题及原因描述

在修改szheats FTP弱密码账户的过程中，出现了上传失败、下载无异常的情况。

经过检查发现之前测试的文件夹可以上传，有部分文件夹无法上传。

![image-20230210153602669](./.assets/typora-user-images/image-20230210153602669.png)

对比发现windows并无此问题，考虑与linux的特性有关。

![image-20230210153702144](./.assets/typora-user-images/image-20230210153702144.png)

![image-20230210153710130](./.assets/typora-user-images/image-20230210153710130.png)

文件夹的权限各不相同，由于新建的账户处于旧帐户所在的组，所以部分组权限可写的，可以上传；而不可写的组，就不可上传了。

![image-20230210153907583](./.assets/typora-user-images/image-20230210153907583.png)

由于无法直接修改文件夹的归属用户（会影响产线的旧帐户异常），所以只能采取扩大权限的方案，加上文件夹的可写组权限。

经过测试，修改权限后，可以正常上传文件。

##### 2.Linux相关文件权限知识

![image-20230210155647967](./.assets/typora-user-images/image-20230210155647967.png)

**2.1 文件权限分类**

对于文件：

读（read）：具有读取文件内容的权限限。
写（write）： 具有修改文件内容的权限的权限。
执行（execute）：具有执行文件的权限。

对于文件夹：

读（read）：查看目录下的文件列表的权限。
写（write）： 具有删除移动目录内文件和创建文件的权限 。
执行（execute）：具有进入目录的权限。

**2.2 用户分类**

拥有者(owner)：文件和文件目录的所有者。
所属组(group)：文件和文件目录的所有者所在的组的用户。
其它用户(other)：不属于上面的两个。

示例：drwxr-xr--

*使用 LL 指令显示文件信息，第一列的第一个字符表示文件的类型

d：文件夹
-：普通文件
l：软链接（类似Windows的快捷方式）
b：块设备文件（例如硬盘、光驱等）
p：管道文件
c：字符设备文件（例如屏幕等串口设备）
s：套接口文件

*对应用户的访问权限，三三一组，顺序对应owner，group，other

**2.3 文件权限的改变**

**更改文件属性**

指令：chmod    设置文件的访问权限

- +：增加权限

- -：取消权限

- u：拥有者 

- g：拥有者同组用

- o：其它用户

- a：所有用户

  *除了这种方法还有一个方式，这里可以把有权限当做1，没权限为0，那么三个二进制就是一个8进制；



**更改文件所属者和拥有者**

chown(更改拥有者)、chgrp(更改所属组)



**2.4文件权限的初始定义**

一个目录被创建，起始权限是从：777开始；一个普通文件被创建，起始权限是从：666开始

但实际上你所创建的文件和目录，看到的权限往往不是上面这个值。原因就是创建文件或目录的时候还要受到 umask 的影响。

最终权限 = 初始权限 & （~umask）